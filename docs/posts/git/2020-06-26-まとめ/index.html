<!DOCTYPE html>
<html class="no-js" lang="ja-JP">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Gitまとめ - Blog</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	
	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/blog/css/style.css">
	
	<link rel="shortcut icon" href="/blog/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/blog/" title="Blog" rel="home">
				<div class="logo__title">Blog</div>
				
			</a>
		</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Gitまとめ</h1>
			
		</header><div class="content post__content clearfix">
			<p>Gitまとめアレコレ</p>
<h2 id="heading">ログの見方</h2>
<p>Git logについてまずは公式サイトを読んでみよう。公式サイトの説明は<a href="https://git-scm.com/book/ja/v2/Git-%E3%81%AE%E5%9F%BA%E6%9C%AC-%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E5%B1%A5%E6%AD%B4%E3%81%AE%E9%96%B2%E8%A6%A7">コチラ</a>から。</p>
<h3 id="log-1">log を1行で見る。</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git log --oneline
</code></pre></div><h3 id="log-">log の整形</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git log --pretty<span style="color:#f92672">=</span>format:<span style="color:#e6db74">&#34;%h %cd %cn &#39;%s&#39;&#34;</span>
 <span style="color:#75715e">## フォーマット：   コミットID    日付    名前    コメント</span>
 <span style="color:#75715e">## 例：252692d Fri Apr 5 08:11:59 2019 +0900 fukugit &#39;バリデータを追加しました。&#39;</span>
</code></pre></div><p>その他のフォーマット項目については<a href="https://git-scm.com/book/ja/v2/Git-%E3%81%AE%E5%9F%BA%E6%9C%AC-%E3%82%B3%E3%83%9F%E3%83%83%E3%83%88%E5%B1%A5%E6%AD%B4%E3%81%AE%E9%96%B2%E8%A6%A7">こちら</a>にまとめてあります。<br>
「git log &ndash;pretty=format 用の便利なオプション」で検索したら一覧が出てきます。</p>
<h3 id="log--1">log と一緒に修正箇所を全て表示する</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git log -p
</code></pre></div><h3 id="heading-1">修正されたファイル名のみを表示する(上記の簡易版)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git log -stat
</code></pre></div><h3 id="heading-2">特定の文字で検索する。</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git log --grep<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;xxxx&#34;</span>
</code></pre></div><h3 id="heading-3">コミットユーザで検索する。</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git log --auther<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;xxxx&#34;</span>
</code></pre></div><h3 id="heading-4">期間で検索する。</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git log --after<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;2020/04/01&#39;</span>
git log --before<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;2020/04/01&#39;</span>
</code></pre></div><hr>
<h2 id="stash">Stash</h2>
<h3 id="stash-1">stashする。</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git add .
git status
git stash save <span style="color:#e6db74">&#34;一旦退避&#34;</span>
git status
</code></pre></div><h3 id="stash-2">stash一覧を見る</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git stash list
</code></pre></div><h3 id="stash-3">stashの中身を見る</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git stash list
git stash show <span style="color:#f92672">{</span>0<span style="color:#f92672">}</span>    <span style="color:#75715e">## {0}はgit stash listで一覧化できます。</span>
git stash show <span style="color:#f92672">{</span>0<span style="color:#f92672">}</span> -P <span style="color:#75715e">## -P オプションで内容も見れます。</span>
</code></pre></div><h3 id="stash-4">stashを消す</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git stash clear     <span style="color:#75715e">## 全消し</span>
git stash drop <span style="color:#f92672">{</span>0<span style="color:#f92672">}</span>  <span style="color:#75715e">## 一部消し</span>
</code></pre></div><h3 id="stash-5">stashを適用する。</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git stash apply <span style="color:#f92672">{</span>0<span style="color:#f92672">}</span>
git stash list  <span style="color:#75715e">## 適用してもstashは消えていません。</span>
git stash drop <span style="color:#f92672">{</span>0<span style="color:#f92672">}</span>
</code></pre></div><h3 id="stash-">stash を適用して同時に消します。</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git stash pop <span style="color:#f92672">{</span>0<span style="color:#f92672">}</span>
</code></pre></div><hr>
<h2 id="pull">pull</h2>
<h3 id="pullrebase">マージコミットを作らずにPullする方法（rebaseのようなイメージ）</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git pull -–rebase origin branchname
</code></pre></div><p><a href="https://kray.jp/blog/git-pull-rebase/">このサイト</a>にgit pull と git pull &ndash;rebase の違いが書かれています。</p>
<hr>
<h2 id="merge">merge</h2>
<h3 id="heading-5">コミット有りマージ</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git merge develop  <span style="color:#75715e">## マージしたらマージ分のコミットIDが付きます。これは他のコミットIDが変更されないことを意味します。一方でrebaseはコミットIDが変わってしまいます。</span>
</code></pre></div><hr>
<h2 id="rebase">Rebase</h2>
<h3 id="2">2つのブランチをマージします。</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git rebase develop
git status             <span style="color:#75715e">## viで競合しているファイルを開いて、競合を解消します。</span>
git add .              <span style="color:#75715e">## このタイミングだとまだどのブランチも選択した状態になっていないけど問題無しです。</span>
git rebase --continue  <span style="color:#75715e">## このタイミングでブランチが選択された状態になります。</span>
<span style="color:#75715e">## 注意！！！ rebaseをすることでコミットIDが変わってしまいます。すでにpush済みの場合はpush -f をしないといけなくなる可能性があるので気をつけて！</span>
</code></pre></div><h3 id="rebase-">rebase の取り消し</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git rebase --abort
</code></pre></div><h3 id="commit">複数commitの集約</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git rebase -i HEAD~2  <span style="color:#75715e">## 過去2つのコミットが対象です。</span>
<span style="color:#75715e">## viが開きます。</span>
pick 4eb0c37 コミットその１
pick 8c5ca88 コミットその２
<span style="color:#75715e">## viで消してしまいたいコミット（集約したいコミット）にs を付けて保存します。</span>
pick 4eb0c37 コミットその１
s 8c5ca88 コミットその２
<span style="color:#75715e">## さらに別のvi が開くのでコミットコメントを整備します。ファイルを保存します。</span>
コミットその１
コミットその２ <span style="color:#75715e">## このコメントが不要なら消します。</span>
<span style="color:#75715e">## これで終わりです。この方法もコミットIDが変わってしまうので気をつけて下さい。</span>
</code></pre></div><hr>
<h2 id="heading-6">■差分チェック</h2>
<h3 id="heading-7">ステージングに乗せる前にカレントブランチとの差分を確認する</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git diff --name-only
</code></pre></div><h3 id="heading-8">ステージングに乗せた後にカレントブランチとの差分を確認する</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git diff --cached --name-only
</code></pre></div><h3 id="heading-9">ブランチ間の差分を確認する(両方コミットする必要あり)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git diff master develop
</code></pre></div><h3 id="heading-10">リモートブランチとの差分を確認する(両方コミットする必要あり)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git diff origin/dvelop develop
</code></pre></div><hr>
<h2 id="heading-11">取り消し系</h2>
<h3 id="git-add-">git add する前のファイル・ディレクトリを元に戻す。（追加したファイルは消せない）</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">1： <span style="color:#75715e">## 適当なファイルを修正(addしない。)</span>
2: git diff --name-only
3: git checkout .
</code></pre></div><h3 id="heading-12">追加したファイルを消すのはこちら。</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">1： <span style="color:#75715e">## 適当なファイルを追加(addしない。)</span>
2: git clean -df 
</code></pre></div><h3 id="heading-13">特定ファイルを１つ前に戻す</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">1: <span style="color:#75715e">## 適当なファイルを修正（コミットされているやつ）</span>
2: git checkout HEAD Test.txt
</code></pre></div><h3 id="git-add---commit-">git add . もしくは commit したあとに取り消す方法</h3>
<p>resetは取り消しがコミットログに残らない。よってpushした後にやるとヤバい。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">1: git add .
2: git diff --cached --name-only
3: git reset --hard HEAD            <span style="color:#75715e">## addしたものが全て削除される。 git checkout . と同じ</span>
4: git reset --hard HEAD^           <span style="color:#75715e">## 1つ前のコミットに戻る。今のコミットは削除される。)</span>
5: git reset --hard vsd122414dsfsfe <span style="color:#75715e">## コミットIDを指定して、コミットIDのところまで戻る。コミットIDを削除するのではないので気を付けること</span>
</code></pre></div><h3 id="resetreset">resetを取り消したい（resetしたけど元の状態に戻したい時用)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">1: git add .
2: git commit -m <span style="color:#e6db74">&#34;test&#34;</span>
3: git reset --hard HEAD      <span style="color:#75715e">## test commit を無かったことに。</span>
4: git reset --hard ORIG_HEAD <span style="color:#75715e">## test commit を復活</span>
</code></pre></div><h3 id="push">pushをした後に取り消す方法</h3>
<p>revertはresetと違ってコミットログに残る。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">1: git add .
2: git commit -m<span style="color:#e6db74">&#34;xxxxxxxxxx&#34;</span>
3: git log                     <span style="color:#75715e">## 取り消し対象のコミットIDを取得</span>
4: git revert vsd122414dsfsfe  <span style="color:#75715e">## 取り消し対象のコミットIDを指定</span>
5: git push
</code></pre></div><hr>
<h2 id="heading-14">コミット</h2>
<h3 id="heading-15">直前のコミットメッセージを修正</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git commit --amend -m<span style="color:#e6db74">&#34;ファイルを追加しました。&#34;</span>
</code></pre></div><h3 id="heading-16">２つ以上前のコミットメッセージを修正</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">## 残念ながら git rebase -i を使うしかないです。</span>
</code></pre></div><h3 id="heading-17">直前のコミットに軽微なコミットを混ぜ込む方法。</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">1: <span style="color:#75715e">## 適当なファイルを修正</span>
2: git add .
3: git commit --amend　<span style="color:#75715e">## 直前のコミットに１を混ぜ込む</span>
</code></pre></div><h3 id="heading-18">コメント付きコミット(一番標準的なもの)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">1: <span style="color:#75715e">## 適当なファイルを修正</span>
2: git add .
3: git commit -m<span style="color:#e6db74">&#34;xxxxxxxxxx&#34;</span>
</code></pre></div><hr>
<h2 id="cherrypick">CherryPick</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git cherry-pick 7c44840faab76c69c0b0a
</code></pre></div><hr>
<h2 id="gitgit-submodule">外部Gitブランチを自分のブランチ内に取り込む(git submodule)</h2>
<p>サブモジュールについては<a href="https://git-scm.com/book/ja/v2/Git-%E3%81%AE%E3%81%95%E3%81%BE%E3%81%96%E3%81%BE%E3%81%AA%E3%83%84%E3%83%BC%E3%83%AB-%E3%82%B5%E3%83%96%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB">公式サイト</a>の説明を一読したほうがよいかもね。</p>
<h3 id="submodule-">submodule 取り込み</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git submodule add サブモジュール化したいリポジトリ パス/名前指定
cd サブモジュール化したディレクトリ
git submodule update --init --recursive
</code></pre></div><h3 id="submodule--1">submodule を削除</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd サブモジュール化したいリポジトリのディレクトリ（トップレベル）
git submodule deinit -f 追加したサブモジュール
git rm -f 追加したサブモジュール
cd 自分のブランチのディレクトリ（トップレベル）
$ rm -rf .git/modules/追加したサブモジュール 
</code></pre></div><hr>
<h2 id="heading-19">削除</h2>
<h3 id="heading-20">ローカルブランチの削除</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git push -D branchname <span style="color:#75715e">##-Dはpush残しがあっても削除する強力なやつ</span>
</code></pre></div><h3 id="heading-21">リモートブランチの削除</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">git push --delete origin feature/test
</code></pre></div>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/blog/tags/git/" rel="tag">git</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/blog/tags/%E3%81%BE%E3%81%A8%E3%82%81/" rel="tag">まとめ</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>




			</div>
			
		</div>
		
	</div>
<script async defer src="/blog/js/menu.js"></script>
</body>
</html>